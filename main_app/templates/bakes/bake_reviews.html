{% load static %} 
<section class="reviews">
    <h2>Reviews</h2>
    {% if bake.review_set.count %}
        <p class="reviewed">{{ bake.name }} has {{ bake.review_set.count }} review(s), but please add more!</p>
    {% else %}
        <p class="not-reviewed">{{ bake.name }} is yet to be reviewed!</p>
    {% endif %}

    {% if user.is_authenticated %}
        <form action="{% url 'review-add' bake.id %}" method="post" class="subsection-content">
            {% csrf_token %} 
            {{ review_form.as_p }} 
            <button type="submit" class="btn submit">Add Review</button>
        </form>
    {% else %}
        <p><a href="{% url 'login' %}">Log in</a> to leave a review!</p>
    {% endif %}

    <h3>Past Reviews</h3>
    {% if bake.review_set.count %}
        <table>
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Rating</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for review in bake.review_set.all %}
                <tr>
                    <td>{{ review.date }}</td>
                    <td>{{ review.get_rating_display }}</td>
                    <td>
                        {% if review.user == user %}
                            <div class="table-actions">
                                <a href="{% url 'review-edit' bake.id review.id %}" class="btn warn">Edit</a>

                                <form action="{% url 'review-delete' bake.id review.id %}" method="POST"> 
                                    {% csrf_token %}
                                    <button type="submit" class="btn-danger">Delete</button>
                                </form>
                            </div>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p>{{ bake.name }} is not yet reviewed! </p>
    {% endif %}
</section>